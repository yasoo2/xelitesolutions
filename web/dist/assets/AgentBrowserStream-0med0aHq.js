import{r as s,j as t,A as Z}from"./index-CKzalOhl.js";function it({wsUrl:O,minimal:g}){var Se,je,Re;const ce=s.useRef(null),T=s.useRef(null),m=s.useRef(null),[x,de]=s.useState({w:1280,h:800}),I=s.useRef({w:1280,h:800}),[v,M]=s.useState("connecting"),[_,N]=s.useState(""),[b,$]=s.useState(""),[F,U]=s.useState([]),[ue,j]=s.useState(""),[w,G]=s.useState("console"),[pe,V]=s.useState(!1),[he,Q]=s.useState([]),[ye,ee]=s.useState([]),[xe,P]=s.useState(1),[k,ge]=s.useState(!1),[Ce,Te]=s.useState(!1),[te,be]=s.useState(!1),[Ee,Me]=s.useState(0),[Ne,Ve]=s.useState('{"list":{"selector":"a[href^=\\"https\\"]:not([href*=\\"google.com\\"])","fields":{"text":{"selector":"","attr":""},"url":{"selector":"","attr":"href"}}}}'),[Qe,re]=s.useState(null),[oe,Fe]=s.useState(""),fe=s.useRef(null),[ne,B]=s.useState(null),[D,Be]=s.useState(!0),[q,me]=s.useState(""),[S,De]=s.useState(""),[L,se]=s.useState(null),[K,et]=s.useState(""),[Y,tt]=s.useState(""),[ve,rt]=s.useState(!0),[Ae,ot]=s.useState(!0),[Ie,nt]=s.useState(!0),[$e,st]=s.useState("أضرار التدخين"),J=s.useRef(0),H=s.useRef(null),X=s.useRef(null),W=s.useRef(0),[f,we]=s.useState(!1),[Ue,ke]=s.useState(!1);s.useEffect(()=>{g&&(V(!1),ge(!1),P(1),be(!1),we(!1))},[g]),s.useEffect(()=>{I.current=x},[x]),s.useEffect(()=>{const e=()=>{Te(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),e(),()=>document.removeEventListener("fullscreenchange",e)},[]);function ae(){try{const o=new URL(O).pathname.split("/").filter(Boolean);return o[o.length-1]}catch{return""}}function ie(e){try{const o=new URL(e);return o.protocol==="ws:"&&(o.protocol="http:"),o.protocol==="wss:"&&(o.protocol="https:"),o.toString()}catch{try{const o=new URL(O);return o.protocol==="ws:"&&(o.protocol="http:"),o.protocol==="wss:"&&(o.protocol="https:"),o.search="",o.hash="",o.pathname="/",new URL(e,o.toString()).toString()}catch{return e}}}function R(e){const o=e.trim();if(!o)return"";try{return new URL(o).toString()}catch{try{return new URL(`https://${o}`).toString()}catch{return o}}}async function i(e){var a;const o=ae();if(!o)return;const h=["mouseMove","click","scroll","type","press","goBack","goForward","reload","goto","screenshot"];if(m.current&&m.current.readyState===WebSocket.OPEN&&e.every(p=>h.includes(p.type))){e.forEach(d=>{var y;(y=m.current)==null||y.send(JSON.stringify({type:"action",action:d}))});const p=e.map(d=>d.type).join(", ");if(j(p),setTimeout(()=>j(""),1200),D&&e.some(d=>d.type==="press"&&d.key==="Enter")&&setTimeout(()=>z(),2e3),D&&e.some(d=>d.type==="reload")&&setTimeout(()=>z(),1500),e.some(d=>d.type==="goto"||d.type==="reload")){if(se(null),ve){const d=[];S?d.push({type:"locate",selector:S}):K&&Y&&d.push({type:"locate",role:K,roleName:Y}),d.length&&setTimeout(()=>i(d),1e3)}D&&setTimeout(()=>z(),1500)}return}try{const p=localStorage.getItem("token"),y=await(await fetch(`${Z}/tools/browser_run/execute`,{method:"POST",headers:{"Content-Type":"application/json",...p?{Authorization:`Bearer ${p}`}:{}},body:JSON.stringify({sessionId:o,actions:e})})).json();if(Array.isArray(y.artifacts)){const r=y.artifacts.map(n=>({name:n.name||n.filename||"download",href:n.href}));U(n=>[...r,...n].slice(0,5))}if(y!=null&&y.ok&&Array.isArray((a=y==null?void 0:y.output)==null?void 0:a.outputs)){const r=y.output.outputs.find(n=>n.type==="locate"&&n.boundingBox);if(r!=null&&r.boundingBox&&(se(r.boundingBox),e.some(c=>c.type==="locate")&&Ae)){const u=[...e].reverse().find(E=>E.type==="locate")||null,A=[];if(u!=null&&u.selector)A.push({type:"click",selector:u.selector});else if(u!=null&&u.role&&(u!=null&&u.roleName))A.push({type:"click",role:u.role,roleName:u.roleName});else{const E=r.boundingBox;if(E){const Ze=Math.round(E.x+E.width/2),Ge=Math.round(E.y+E.height/2);A.push({type:"click",x:Ze,y:Ge})}}A.length&&setTimeout(()=>i(A),250);const He=!!(u!=null&&u.selector&&/(input|textarea)\[name=["']q["']\]/i.test(String(u.selector))),Xe=!!(u!=null&&u.roleName&&String(u.roleName).includes("بحث"));Ie&&!q.trim()&&(He||Xe)&&setTimeout(()=>{i([{type:"waitForSelector",selector:'input[name="q"], textarea[name="q"]',timeoutMs:8e3}]),setTimeout(()=>i([{type:"type",text:$e,delay:30}]),200),setTimeout(()=>i([{type:"press",key:"Enter"}]),300)},400)}}const C=e.map(r=>r.type).join(", ");if(j(C),setTimeout(()=>j(""),1200),e.some(r=>r.type==="goto"||r.type==="reload")&&(se(null),ve)){const r=[];if(S)r.push({type:"locate",selector:S});else if(K&&Y)r.push({type:"locate",role:K,roleName:Y});else{const n=e.find(c=>c.type==="goto");try{const c=n!=null&&n.url?new URL(n.url).hostname:"";c&&/(^|\.)(google)\./i.test(c)&&r.push({type:"locate",selector:'input[name="q"], textarea[name="q"]'})}catch{}}r.length&&setTimeout(()=>i(r),1e3)}D&&e.some(r=>r.type==="press"&&r.key==="Enter")&&setTimeout(()=>{z()},2e3),D&&e.some(r=>r.type==="goto"||r.type==="reload")&&setTimeout(()=>{z()},1500)}catch{}}async function z(){const e=ae();if(e)try{const o=localStorage.getItem("token"),h=JSON.parse(Ne),a=await(await fetch(`${Z}/tools/browser_extract/execute`,{method:"POST",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}},body:JSON.stringify({sessionId:e,schema:h})})).json();a!=null&&a.ok&&(a!=null&&a.output)?re(a.output):re(null)}catch{re(null)}}async function Le(){var h,l;const e=ae(),o=(l=(h=fe.current)==null?void 0:h.files)==null?void 0:l[0];if(!(!e||!o||!oe))try{const a=localStorage.getItem("token"),p=new FormData;p.append("file",o),p.append("sessionId",e);const y=await(await fetch(`${Z}/files/upload`,{method:"POST",headers:{...a?{Authorization:`Bearer ${a}`}:{}},body:p})).json();if(y&&y._id){const C=`${Z}/files/${y._id}/raw`;await i([{type:"uploadFile",selector:oe,fileUrl:C}])}}catch{}}s.useEffect(()=>{let e=!1;W.current=0,M("connecting"),N("");const o=()=>{H.current!=null&&(window.clearTimeout(H.current),H.current=null),X.current!=null&&(window.clearTimeout(X.current),X.current=null)},h=()=>{if(!e){o();try{if(m.current){try{m.current.close()}catch{}m.current=null}const l=new WebSocket(O);m.current=l,M(W.current>0?"reconnecting":"connecting"),X.current=window.setTimeout(()=>{try{l.readyState!==WebSocket.OPEN&&l.close()}catch{}},8e3),l.onopen=()=>{o(),!e&&(W.current=0,N(""),M("connected"))},l.onclose=a=>{if(o(),e)return;m.current=null;const p=8,d=W.current+1;if(W.current=d,d>p){M("error");const c=a!=null&&a.reason?` reason=${a.reason}`:"";N(`WebSocket closed (code=${(a==null?void 0:a.code)??"unknown"}${c})`);return}const y=Math.min(8e3,500*Math.pow(2,d-1)),C=Math.floor(Math.random()*250),r=y+C;M("reconnecting");const n=a!=null&&a.reason?` reason=${a.reason}`:"";N(`WebSocket closed (code=${(a==null?void 0:a.code)??"unknown"}${n}). retrying...`),H.current=window.setTimeout(h,r)},l.onerror=()=>{e||N("WebSocket error")},l.onmessage=a=>{var p,d,y,C;try{const r=JSON.parse(a.data);if(r.type==="stream_start"){const n={w:r.w,h:r.h};I.current=n,de(n)}if(r.type==="state"){if((p=r.viewport)!=null&&p.width&&((d=r.viewport)!=null&&d.height)){const n={w:r.viewport.width,h:r.viewport.height};I.current=n,de(n)}if(typeof r.url=="string"&&$(r.url),Array.isArray(r.downloads)){const n=r.downloads.map(c=>({name:c.filename||c.name||"download",href:ie(c.href)}));U(n.slice(-10).reverse())}Array.isArray(r.logs)&&Q(r.logs.slice(-500)),Array.isArray(r.network)&&ee(r.network.slice(-500))}if(r.type==="url"&&typeof r.url=="string"&&$(r.url),r.type==="console"&&r.entry&&Q(n=>[...n,r.entry].slice(-500)),r.type==="network"&&r.entry&&ee(n=>[...n,r.entry].slice(-500)),r.type==="download"&&r.download){const n=r.download,c={name:n.filename||n.name||"download",href:ie(n.href)};U(u=>[c,...u].slice(0,10))}if(r.type==="screenshot"&&r.href){const n=ie(String(r.href)),c=String(r.href).split("/").pop()||"screenshot.jpg";U(u=>[{name:c,href:n},...u].slice(0,10))}if(r.type==="cursor_move"&&B({x:r.x,y:r.y}),r.type==="cursor_click"){B({x:r.x,y:r.y});const n=document.createElement("div"),c=I.current;n.style.cssText=`
                position: absolute;
                left: ${r.x/c.w*100}%;
                top: ${r.y/c.h*100}%;
                width: 20px; height: 20px;
                background: rgba(255, 0, 0, 0.5);
                border-radius: 50%;
                transform: translate(-50%, -50%);
                pointer-events: none;
                z-index: 100;
                transition: opacity 0.5s;
              `,(C=(y=T.current)==null?void 0:y.parentElement)==null||C.appendChild(n),setTimeout(()=>n.remove(),500)}if(r.type==="action_start"){const n=r.action;let c=n.type;n.type==="goto"&&(c=`Opening ${new URL(n.url).hostname}...`),n.type==="type"&&(c="Typing..."),n.type==="click"&&(c="Clicking..."),n.type==="scroll"&&(c="Scrolling..."),n.type==="screenshot"&&(c="Capturing View..."),j(c)}if(r.type==="action_done"&&setTimeout(()=>j(""),500),r.type==="action_error"&&(j(String(r.error||"Action error")),setTimeout(()=>j(""),1500)),r.type==="frame"){if(te)return;const n=new Image;n.onload=()=>{const c=T.current;if(!c)return;const u=I.current;c.width=u.w,c.height=u.h,c.getContext("2d").drawImage(n,0,0,u.w,u.h)},n.src="data:image/jpeg;base64,"+r.jpegBase64}}catch{}}}catch(l){M("error"),N(String((l==null?void 0:l.message)||l))}}};return h(),()=>{var l;e=!0,o();try{(l=m.current)==null||l.close()}catch{}m.current=null}},[O,Ee]);function We(e){if(!f)return;const o=T.current;if(!o)return;try{o.focus()}catch{}const h=o.getBoundingClientRect(),l=Math.round((e.clientX-h.left)*(x.w/h.width)),a=Math.round((e.clientY-h.top)*(x.h/h.height));i([{type:"click",x:l,y:a}]),B({x:l,y:a})}function ze(e){if(!f)return;e.preventDefault();const o=Math.round(e.deltaY);i([{type:"scroll",deltaY:o}])}function Oe(e){if(!f)return;const o=Date.now();if(o-(J.current||0)<60)return;J.current=o;const h=T.current;if(!h)return;const l=h.getBoundingClientRect(),a=Math.round((e.clientX-l.left)*(x.w/l.width)),p=Math.round((e.clientY-l.top)*(x.h/l.height));B({x:a,y:p}),i([{type:"mouseMove",x:a,y:p,steps:2}])}function _e(e){var d;if(!f)return;const o=T.current,h=(d=e.touches)==null?void 0:d[0];if(!o||!h)return;e.preventDefault();const l=o.getBoundingClientRect(),a=Math.round((h.clientX-l.left)*(x.w/l.width)),p=Math.round((h.clientY-l.top)*(x.h/l.height));i([{type:"click",x:a,y:p}]),B({x:a,y:p})}function Pe(e){var y;if(!f)return;const o=Date.now();if(o-(J.current||0)<60)return;J.current=o;const h=T.current,l=(y=e.touches)==null?void 0:y[0];if(!h||!l)return;e.preventDefault();const a=h.getBoundingClientRect(),p=Math.round((l.clientX-a.left)*(x.w/a.width)),d=Math.round((l.clientY-a.top)*(x.h/a.height));B({x:p,y:d}),i([{type:"mouseMove",x:p,y:d,steps:2}])}function qe(){q.trim()&&(i([{type:"type",text:q,delay:30}]),me(""))}const[le,Ke]=s.useState(!1);function Ye(e){if(f){if(e.key==="Enter"){e.preventDefault(),i([{type:"press",key:"Enter"}]);return}if(e.key==="Backspace"){e.preventDefault(),i([{type:"press",key:"Backspace"}]);return}if(e.key==="Tab"){e.preventDefault(),i([{type:"press",key:"Tab"}]);return}if(e.key==="Escape"){e.preventDefault(),i([{type:"press",key:"Escape"}]);return}if(e.key==="ArrowUp"||e.key==="ArrowDown"||e.key==="ArrowLeft"||e.key==="ArrowRight"){e.preventDefault(),i([{type:"press",key:e.key}]);return}e.ctrlKey||e.metaKey||e.altKey||e.key&&e.key.length===1&&(e.preventDefault(),i([{type:"type",text:e.key,delay:0}]))}}const Je=t.jsxs("div",{style:{position:"absolute",top:10,left:10,right:10,zIndex:60,display:"flex",alignItems:"center",gap:8},children:[t.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:v==="connected"?"var(--accent-success)":v==="reconnecting"?"var(--accent-warning)":"var(--accent-danger)",boxShadow:v==="connected"?"0 0 8px var(--accent-success)":"none",flex:"0 0 auto"}}),t.jsx("button",{onClick:()=>we(e=>!e),style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:f?"rgba(37, 99, 235, 0.18)":"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer",flex:"0 0 auto"},children:f?"تحكم: مفعل":"تحكم: متوقف"}),t.jsx("button",{onClick:()=>i([{type:"goBack"}]),title:"Back",style:{width:34,height:32,borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer",flex:"0 0 auto"},children:"⟵"}),t.jsx("button",{onClick:()=>i([{type:"goForward"}]),title:"Forward",style:{width:34,height:32,borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer",flex:"0 0 auto"},children:"⟶"}),t.jsx("button",{onClick:()=>i([{type:"reload"}]),title:"Reload",style:{width:34,height:32,borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer",flex:"0 0 auto"},children:"⟳"}),t.jsx("input",{type:"text",value:b,onChange:e=>$(e.target.value),onKeyDown:e=>{if(e.key==="Enter"){const o=R(b);o&&i([{type:"goto",url:o,waitUntil:"domcontentloaded"}])}},placeholder:"https://example.com",dir:"auto",style:{flex:"1 1 auto",height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(0,0,0,0.55)",color:"var(--text-primary)",outline:"none",minWidth:140,backdropFilter:"blur(8px)"}}),t.jsx("button",{onClick:()=>{const e=R(b);e&&i([{type:"goto",url:e,waitUntil:"domcontentloaded"}])},style:{height:32,padding:"0 12px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(37, 99, 235, 0.18)",color:"var(--text-primary)",cursor:"pointer",flex:"0 0 auto"},children:"فتح"}),_?t.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",maxWidth:420},dir:"auto",children:_}):null]});return t.jsxs("div",{ref:ce,className:"agent-browser-stream",style:{display:"flex",flexDirection:"column",gap:g?0:8,position:k?"fixed":"relative",inset:k?12:void 0,zIndex:k?9999:void 0,background:k?"var(--bg-dark)":void 0,padding:k?12:void 0,borderRadius:k?16:void 0,border:k?"1px solid var(--border-color)":void 0,boxShadow:k?"0 12px 50px rgba(0,0,0,0.6)":void 0,height:g?"100%":void 0},children:[g?Je:null,g?null:t.jsxs("div",{className:"agent-browser-header",style:{display:"flex",alignItems:"center",padding:"10px 12px",background:"var(--bg-secondary)",borderRadius:12,border:"1px solid var(--border-color)",gap:8,flexWrap:"wrap"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,whiteSpace:"nowrap"},children:[t.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:v==="connected"?"var(--accent-success)":v==="reconnecting"?"var(--accent-warning)":"var(--accent-danger)",boxShadow:v==="connected"?"0 0 8px var(--accent-success)":"none"}}),t.jsx("span",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)"},dir:"auto",children:v==="connected"?"متصل":v}),v==="error"?t.jsx("button",{onClick:()=>Me(e=>e+1),style:{height:28,padding:"0 10px",borderRadius:8,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.04)",color:"var(--text-primary)",cursor:"pointer"},children:"إعادة اتصال"}):null]}),t.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flex:"1 1 420px",minWidth:260},children:[t.jsx("button",{onClick:()=>i([{type:"goBack"}]),title:"Back",style:{width:32,height:32,borderRadius:8,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"⟵"}),t.jsx("button",{onClick:()=>i([{type:"goForward"}]),title:"Forward",style:{width:32,height:32,borderRadius:8,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"⟶"}),t.jsx("button",{onClick:()=>i([{type:"reload"}]),title:"Reload",style:{width:32,height:32,borderRadius:8,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"⟳"}),t.jsx("input",{type:"text",value:b,onChange:e=>$(e.target.value),onKeyDown:e=>{if(e.key==="Enter"){const o=R(b);o&&i([{type:"goto",url:o,waitUntil:"domcontentloaded"}])}},placeholder:"https://example.com",dir:"auto",style:{flex:1,height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"var(--bg-primary)",color:"var(--text-primary)",outline:"none",minWidth:200}}),t.jsx("button",{onClick:()=>{const e=R(b);e&&i([{type:"goto",url:e,waitUntil:"domcontentloaded"}])},style:{height:32,padding:"0 12px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(37, 99, 235, 0.12)",color:"var(--text-primary)",cursor:"pointer"},children:"فتح"})]}),t.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[t.jsx("button",{onClick:()=>{const e=R(b);e&&navigator.clipboard&&navigator.clipboard.writeText(e).catch(()=>{})},title:"Copy URL",style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"نسخ"}),t.jsx("button",{onClick:()=>{const e=R(b);e&&window.open(e,"_blank","noreferrer")},title:"Open in new tab",style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"فتح خارجي"}),t.jsx("button",{onClick:()=>i([{type:"screenshot",fullPage:!1,quality:60}]),title:"Screenshot",style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"لقطة"}),t.jsx("button",{onClick:()=>{const e=F[0];e!=null&&e.href&&window.open(e.href,"_blank","noreferrer")},disabled:!((Se=F[0])!=null&&Se.href),title:"Open latest download",style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:(je=F[0])!=null&&je.href?"pointer":"not-allowed",opacity:(Re=F[0])!=null&&Re.href?1:.5},children:"تنزيل"}),t.jsx("button",{onClick:()=>P(e=>Math.max(.5,Number((e-.1).toFixed(2)))),title:"Zoom out",style:{width:32,height:32,borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"−"}),t.jsxs("button",{onClick:()=>P(1),title:"Reset zoom",style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:[Math.round(xe*100),"%"]}),t.jsx("button",{onClick:()=>P(e=>Math.min(2,Number((e+.1).toFixed(2)))),title:"Zoom in",style:{width:32,height:32,borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"+"}),t.jsx("button",{onClick:async()=>{var e;try{document.fullscreenElement?await document.exitFullscreen():await((e=ce.current)==null?void 0:e.requestFullscreen())}catch{}},title:"Fullscreen",style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:Ce?"خروج":"ملء"}),t.jsx("button",{onClick:()=>be(e=>!e),title:"Pause stream",style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:te?"rgba(37, 99, 235, 0.12)":"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:te?"تشغيل":"إيقاف"}),t.jsx("button",{onClick:()=>ge(e=>!e),title:"Focus mode",style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:k?"rgba(37, 99, 235, 0.12)":"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"تركيز"}),t.jsx("button",{onClick:()=>V(e=>!e),title:"Logs",style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:pe?"rgba(37, 99, 235, 0.12)":"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"سجلات"}),t.jsx("button",{onClick:()=>Ke(!le),style:{height:32,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:le?"أقل":"أكثر"})]}),_?t.jsx("div",{style:{width:"100%",fontSize:12,color:"var(--text-secondary)"},dir:"auto",children:_}):null,ue?t.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center"},children:t.jsx("div",{style:{padding:"4px 12px",background:"rgba(59, 130, 246, 0.15)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:999,color:"#60a5fa",fontSize:12},dir:"auto",children:ue})}):null]}),t.jsx("div",{style:{border:g?"none":"1px solid var(--border-color)",borderRadius:g?0:14,overflow:"hidden",position:"relative",background:"#000",boxShadow:g?"none":"0 4px 20px rgba(0,0,0,0.3)",flex:g?1:void 0},children:t.jsxs("div",{style:{transform:g?"none":`scale(${xe})`,transformOrigin:"top left",position:"relative"},children:[t.jsx("canvas",{ref:T,onClick:We,onWheel:ze,onMouseMove:Oe,onTouchStart:_e,onTouchMove:Pe,tabIndex:f?0:-1,onFocus:()=>ke(!0),onBlur:()=>ke(!1),onKeyDown:Ye,style:{width:"100%",height:"auto",display:"block",cursor:f?"crosshair":"default",touchAction:"none",outline:"none"}}),g&&f&&!Ue?t.jsx("div",{style:{position:"absolute",left:12,bottom:12,zIndex:70,padding:"6px 10px",borderRadius:12,background:"rgba(0,0,0,0.55)",border:"1px solid rgba(255,255,255,0.12)",color:"rgba(255,255,255,0.85)",fontSize:12,backdropFilter:"blur(8px)"},dir:"auto",children:"اضغط داخل المتصفح لتفعيل لوحة المفاتيح"}):null,L&&t.jsx("div",{style:{position:"absolute",left:`${L.x/x.w*100}%`,top:`${L.y/x.h*100}%`,width:`${L.width/x.w*100}%`,height:`${L.height/x.h*100}%`,border:"2px solid #eab308",boxShadow:"0 0 15px rgba(234, 179, 8, 0.4)",pointerEvents:"none",borderRadius:4,transition:"all 0.2s ease"}}),ne&&t.jsx("div",{style:{position:"absolute",left:`${ne.x/x.w*100}%`,top:`${ne.y/x.h*100}%`,transform:"translate(-50%, -50%)",pointerEvents:"none",zIndex:50,transition:"all 0.1s linear"},children:t.jsx("div",{style:{width:12,height:12,borderRadius:"50%",background:"#eab308",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"}})})]})}),!g&&pe?t.jsxs("div",{style:{border:"1px solid var(--border-color)",borderRadius:12,background:"var(--bg-secondary)",overflow:"hidden"},children:[t.jsxs("div",{style:{display:"flex",gap:8,padding:10,borderBottom:"1px solid var(--border-color)",flexWrap:"wrap",alignItems:"center"},children:[t.jsx("button",{onClick:()=>G("console"),style:{height:30,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:w==="console"?"rgba(37, 99, 235, 0.12)":"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"Console"}),t.jsx("button",{onClick:()=>G("network"),style:{height:30,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:w==="network"?"rgba(37, 99, 235, 0.12)":"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"Network"}),t.jsx("button",{onClick:()=>G("downloads"),style:{height:30,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:w==="downloads"?"rgba(37, 99, 235, 0.12)":"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"Downloads"}),t.jsxs("div",{style:{marginInlineStart:"auto",display:"flex",gap:8,alignItems:"center"},children:[t.jsx("button",{onClick:()=>{w==="console"&&Q([]),w==="network"&&ee([]),w==="downloads"&&U([])},style:{height:30,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"Clear"}),t.jsx("button",{onClick:()=>V(!1),style:{height:30,padding:"0 10px",borderRadius:10,border:"1px solid var(--border-color)",background:"rgba(255,255,255,0.03)",color:"var(--text-primary)",cursor:"pointer"},children:"إخفاء"})]})]}),t.jsxs("div",{style:{maxHeight:220,overflow:"auto",padding:10,fontSize:12,color:"var(--text-primary)",fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},children:[w==="console"?he.length?he.slice(-200).map((e,o)=>t.jsxs("div",{style:{opacity:.95,padding:"2px 0"},dir:"auto",children:[t.jsx("span",{style:{color:e.level==="error"?"var(--accent-danger)":e.level==="warning"||e.level==="warn"?"var(--accent-warning)":"var(--text-secondary)"},children:new Date(e.ts).toLocaleTimeString()})," ",e.text]},o)):t.jsx("div",{style:{color:"var(--text-secondary)"},children:"لا توجد رسائل"}):null,w==="network"?ye.length?ye.slice(-200).map((e,o)=>t.jsxs("div",{style:{opacity:.95,padding:"2px 0"},dir:"auto",children:[t.jsx("span",{style:{color:"var(--text-secondary)"},children:new Date(e.ts).toLocaleTimeString()})," ",t.jsx("span",{style:{color:e.stage==="response"&&typeof e.status=="number"&&e.status>=400?"var(--accent-danger)":"var(--text-primary)"},children:e.method})," ",e.stage==="response"?t.jsx("span",{style:{color:"var(--text-secondary)"},children:e.status??""}):t.jsx("span",{style:{color:"var(--text-secondary)"},children:"→"})," ",e.url]},o)):t.jsx("div",{style:{color:"var(--text-secondary)"},children:"لا توجد طلبات"}):null,w==="downloads"?F.length?F.map((e,o)=>t.jsx("div",{style:{padding:"2px 0"},dir:"auto",children:t.jsx("a",{href:e.href,target:"_blank",rel:"noreferrer",style:{color:"#3b82f6",textDecoration:"none"},children:e.name})},o)):t.jsx("div",{style:{color:"var(--text-secondary)"},children:"لا توجد تنزيلات"}):null]})]}):null,le&&t.jsxs("div",{style:{padding:12,border:"1px solid var(--border-color)",borderRadius:8,background:"var(--bg-secondary)",display:"flex",flexDirection:"column",gap:12},children:[t.jsxs("div",{className:"agent-browser-controls-row",style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[t.jsx("button",{onClick:()=>i([{type:"goBack"}]),className:"btn",title:"Back",children:"⟵"}),t.jsx("button",{onClick:()=>i([{type:"goForward"}]),className:"btn",title:"Forward",children:"⟶"}),t.jsx("button",{onClick:()=>i([{type:"reload"}]),className:"btn",title:"Reload",children:"⟳"}),t.jsx("input",{type:"text",value:b,onChange:e=>$(e.target.value),onKeyDown:e=>{e.key==="Enter"&&b&&i([{type:"goto",url:R(b),waitUntil:"domcontentloaded"}])},placeholder:"https://example.com",style:{flex:1,minWidth:220,padding:"8px 10px",borderRadius:8,border:"1px solid var(--border-color)",background:"var(--bg-primary)",color:"var(--text-primary)"}}),t.jsx("button",{onClick:()=>b&&i([{type:"goto",url:R(b),waitUntil:"domcontentloaded"}]),className:"btn",children:"Go"})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:8},children:[t.jsxs("div",{style:{display:"flex",gap:4},children:[t.jsx("input",{type:"text",placeholder:"Upload Selector",value:oe,onChange:e=>Fe(e.target.value),style:{flex:1,padding:4,borderRadius:4,border:"1px solid var(--border-color)"}}),t.jsx("input",{type:"file",ref:fe,style:{width:80}}),t.jsx("button",{onClick:Le,className:"btn",children:"Up"})]}),t.jsxs("div",{style:{display:"flex",gap:4},children:[t.jsx("input",{type:"text",value:q,onChange:e=>me(e.target.value),placeholder:"Type text...",style:{flex:1,padding:4,borderRadius:4,border:"1px solid var(--border-color)"}}),t.jsx("button",{onClick:qe,className:"btn",children:"Type"}),t.jsx("button",{onClick:()=>i([{type:"press",key:"Enter"}]),className:"btn",children:"Ent"})]}),t.jsxs("div",{style:{display:"flex",gap:4},children:[t.jsx("input",{type:"text",value:S,onChange:e=>De(e.target.value),placeholder:"CSS Selector",style:{flex:1,padding:4,borderRadius:4,border:"1px solid var(--border-color)"}}),t.jsx("button",{onClick:()=>S&&i([{type:"locate",selector:S}]),className:"btn",children:"Loc"}),t.jsx("button",{onClick:()=>S&&i([{type:"click",selector:S}]),className:"btn",children:"Clk"})]})]}),t.jsxs("div",{style:{fontSize:11,color:"var(--text-secondary)"},children:["DevTools: ",t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:D,onChange:e=>Be(e.target.checked)})," Auto Extract"]})]})]})]})}export{it as default};
